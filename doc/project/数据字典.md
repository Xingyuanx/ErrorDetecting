# 数据字典

## app_configurations
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | bigint NOT NULL | 主键ID |
| config_type | character varying(20) NOT NULL | 配置类型(system/alert_rule/notification/llm) |
| config_key | character varying(100) NOT NULL | 配置键 |
| config_value | jsonb NOT NULL | 配置值(JSONB) |
| description | character varying(500) | 配置描述 |
| is_enabled | boolean DEFAULT true NOT NULL | 是否启用 |
| created_at | timestamp with time zone DEFAULT now() NOT NULL | 创建时间 |
| updated_at | timestamp with time zone DEFAULT now() NOT NULL | 更新时间 |

## chat_messages
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | integer NOT NULL |  |
| session_id | character varying NOT NULL |  |
| role | character varying NOT NULL |  |
| content | text NOT NULL |  |
| created_at | timestamp with time zone |  |
| reasoning | text |  |
| username | character varying(64) |  |

## chat_sessions
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | character varying NOT NULL |  |
| user_id | integer |  |
| title | character varying |  |
| created_at | timestamp with time zone |  |
| updated_at | timestamp with time zone |  |

## cluster_metrics
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | integer NOT NULL |  |
| cluster_id | integer NOT NULL |  |
| timestamp | timestamp with time zone NOT NULL |  |
| cpu_avg | double precision |  |
| mem_used_avg | double precision |  |
| mem_free_avg | double precision |  |

## clusters
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | bigint NOT NULL | 主键ID |
| uuid | uuid NOT NULL | 集群唯一标识(UUID) |
| name | character varying(100) NOT NULL | 集群名称 |
| type | character varying(50) NOT NULL | 集群类型 |
| node_count | integer DEFAULT 0 NOT NULL | 集群节点数量 |
| health_status | character varying(20) DEFAULT 'unknown'::character varying NOT NULL | 集群健康状态(healthy/warning/error/unknown) |
| description | text | 集群描述 |
| config_info | jsonb | 集群配置信息(JSONB) |
| created_at | timestamp with time zone DEFAULT now() NOT NULL | 创建时间 |
| updated_at | timestamp with time zone DEFAULT now() NOT NULL | 更新时间 |
| namenode_ip | inet |  |
| namenode_psw | character varying(255) |  |
| rm_ip | inet |  |
| rm_psw | character varying(255) |  |

## hadoop_exec_logs
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | integer NOT NULL |  |
| from_user_id | integer NOT NULL |  |
| cluster_name | character varying(255) NOT NULL |  |
| description | text |  |
| start_time | timestamp with time zone |  |
| end_time | timestamp with time zone |  |

## hadoop_logs
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| log_id | integer NOT NULL |  |
| cluster_name | character varying(255) NOT NULL |  |
| node_host | character varying(100) NOT NULL |  |
| title | character varying(255) |  |
| info | text |  |
| log_time | timestamp with time zone NOT NULL |  |

## node_metrics
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | integer NOT NULL |  |
| cluster_id | integer |  |
| node_name | character varying(100) NOT NULL |  |
| timestamp | timestamp with time zone NOT NULL |  |
| cpu_usage | double precision |  |
| mem_used | double precision |  |
| mem_free | double precision |  |

## nodes
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | bigint NOT NULL | 主键ID |
| uuid | uuid NOT NULL | 节点唯一标识(UUID) |
| cluster_id | bigint NOT NULL | 所属集群ID |
| hostname | character varying(100) NOT NULL | 节点主机名 |
| ip_address | inet NOT NULL | 节点IP地址(INET, 兼容IPv4/IPv6) |
| status | character varying(20) DEFAULT 'unknown'::character varying NOT NULL | 节点健康状态(healthy/unhealthy/warning/unknown) |
| cpu_usage | numeric(5,2) | CPU使用率(%) |
| memory_usage | numeric(5,2) | 内存使用率(%) |
| disk_usage | numeric(5,2) | 磁盘使用率(%) |
| last_heartbeat | timestamp with time zone | 最后心跳时间 |
| created_at | timestamp with time zone DEFAULT now() NOT NULL | 创建时间 |
| updated_at | timestamp with time zone DEFAULT now() NOT NULL | 更新时间 |
| ssh_user | character varying(50) |  |
| ssh_password | character varying(255) |  |

## permissions
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | bigint NOT NULL | 主键ID |
| permission_name | character varying(100) NOT NULL | 权限名称 |
| permission_key | character varying(100) NOT NULL | 权限唯一标识 |
| description | character varying(255) | 权限描述 |
| created_at | timestamp with time zone DEFAULT now() NOT NULL | 创建时间 |

## repair_templates
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | bigint NOT NULL | 主键ID |
| template_name | character varying(100) NOT NULL | 模板名称 |
| fault_type | character varying(50) NOT NULL | 适用故障类型 |
| script_content | text NOT NULL | 脚本内容 |
| risk_level | character varying(20) DEFAULT 'medium'::character varying NOT NULL | 风险级别(low/medium/high) |
| description | text | 模板描述 |
| parameters | jsonb | 模板参数定义(JSONB) |
| created_by | character varying(50) | 创建人 |
| created_at | timestamp with time zone DEFAULT now() NOT NULL | 创建时间 |
| updated_at | timestamp with time zone DEFAULT now() NOT NULL | 更新时间 |

## role_permission_mapping
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| role_id | bigint NOT NULL | 角色ID |
| permission_id | bigint NOT NULL | 权限ID |

## roles
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | bigint NOT NULL | 主键ID |
| role_name | character varying(50) NOT NULL | 角色名称 |
| role_key | character varying(50) NOT NULL | 角色唯一标识 |
| description | character varying(255) | 角色描述 |
| is_system_role | boolean DEFAULT false NOT NULL | 是否为系统内置角色 |
| created_at | timestamp with time zone DEFAULT now() NOT NULL | 创建时间 |
| updated_at | timestamp with time zone DEFAULT now() NOT NULL | 更新时间 |

## sys_exec_logs
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| operation_id | uuid DEFAULT public.uuid_generate_v4() NOT NULL |  |
| user_id | integer NOT NULL |  |
| description | text NOT NULL |  |
| operation_time | timestamp with time zone DEFAULT now() NOT NULL |  |

## user_cluster_mapping
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | bigint NOT NULL | 主键ID |
| user_id | bigint NOT NULL | 用户ID |
| cluster_id | bigint NOT NULL | 集群ID |
| role_id | bigint NOT NULL | 角色ID |
| created_at | timestamp with time zone DEFAULT now() NOT NULL | 创建时间 |

## user_role_mapping
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| user_id | bigint NOT NULL | 用户ID |
| role_id | bigint NOT NULL | 角色ID |

## users
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | bigint NOT NULL | 主键ID |
| username | character varying(50) NOT NULL | 用户名 |
| email | character varying(100) NOT NULL | 邮箱 |
| password_hash | character varying(255) NOT NULL | 密码哈希 |
| full_name | character varying(100) NOT NULL | 姓名 |
| is_active | boolean DEFAULT true NOT NULL | 是否激活 |
| last_login | timestamp with time zone | 最后登录时间 |
| created_at | timestamp with time zone DEFAULT now() NOT NULL | 创建时间 |
| updated_at | timestamp with time zone DEFAULT now() NOT NULL | 更新时间 |
