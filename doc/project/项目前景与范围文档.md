# 基于 Hadoop 的故障检测与智能诊断项目 - 前景与范围文档

## 1. 项目愿景
本项目旨在构建一个集“实时监控、日志采集、智能诊断、自动化运维”于一体的 Hadoop 集群治理平台。通过引入大语言模型（LLM）智能体，将复杂的 Hadoop 日志与运行指标转化为直观的诊断报告与操作建议，降低运维门槛，提升集群稳定性。

## 2. 业务目标
- **实时感知**: 自动化采集集群节点 CPU、内存等核心指标，秒级感知异常。
- **智能分析**: 利用 AI 智能体自动解析 Hadoop 远程日志，准确定位 NameNode、DataNode 等组件故障。
- **高效采集**: 建立基于 SSH 的增量日志采集链路，支持多集群、多节点并发处理。
- **闭环管理**: 提供从故障发现、AI 诊断、工具修复到执行审计的完整闭环流程。

## 3. 目标用户与角色
- **系统管理员 (Admin)**: 负责集群注册、用户权限分配、全局系统配置。
- **运维工程师 (Operator)**: 负责日常监控、触发 AI 诊断、执行远程修复命令、查看执行日志。
- **观察员 (Observer)**: 仅限查看监控报表、日志信息及诊断历史，无操作权限。

## 4. 关键使用场景
- **集群健康监控**: 在仪表板实时查看各节点负载趋势，及时发现性能瓶颈。
- **自动化日志巡检**: 系统自动增量采集 Hadoop 关键组件日志，运维人员可随时检索历史记录。
- **AI 辅助故障诊断**: 针对特定异常，调用诊断智能体，由其自动收集日志并生成详细的根因分析报告。
- **远程指令执行**: 无需登录服务器，直接通过 Web 端向指定节点发送运维指令，并自动记录执行过程。

## 5. 项目范围 (In/Out)
### 5.1 包含范围 (In Scope)
- **后端服务 (FastAPI)**:
    - 基于 JWT 的用户认证与权限控制。
    - 基于 SSH 的远程命令执行、文件读取及增量日志采集 (log_collector)。
    - 周期性的集群指标采集与存储 (metrics_worker)。
    - 集成 LangChain 与 OpenAI 的诊断智能体 (diagnosis_agent)。
- **数据管理**:
    - PostgreSQL 持久化存储用户、集群、节点、日志及指标数据。
    - 动态指标表结构保障机制。
- **AI 能力**:
    - 故障根因分析、修复建议生成、远程工具链自动调用。

### 5.2 不包含范围 (Out of Scope)
- 跨租户的复杂计费系统。
- 深度集成第三方 CMDB 或企业级 OA 流程。
- 非 Hadoop 生态（如 K8s 内部治理）的深度管控。

## 6. 技术约束与依赖
- **后端**: Python 3.10+ / FastAPI / SQLAlchemy (Async) / Paramiko (SSH)。
- **数据库**: PostgreSQL 14+。
- **AI 服务**: OpenAI API / LangChain。
- **部署**: 支持 Linux 环境一键脚本启动，支持 SOCKS5 代理通信。

## 7. 风险与应对
- **SSH 稳定性**: 通过连接池管理与超时重试机制应对网络波动。
- **AI 幻觉风险**: 引入诊断报告人工审核机制，关键修复指令需二次确认。
- **性能挑战**: 针对大规模日志采集，采用线程化并发处理与批量入库策略。
- **安全性**: 严格管理 SSH 密钥与 JWT 令牌，所有敏感操作强制审计留痕。

## 8. 成功度量 (KPI)
- **诊断准确率**: AI 提供的故障根因与实际匹配度 ≥ 85%。
- **响应时效**: 节点异常感知延迟 ≤ 30 秒；AI 诊断报告生成时间 ≤ 2 分钟。
- **系统可用性**: 后端 API 可用率 ≥ 99.9%。
