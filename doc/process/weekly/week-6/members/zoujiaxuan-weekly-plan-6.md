# 第六周个人周计划（运维组）— 邹嘉轩（zoujiaxuan-weekly-plan-6）

## 本周总体目标
- 完成 Hadoop 集群的基础部署与可用性验收（至少 1 NameNode + 2 DataNode）。
- 建立初始日志采集链路（Flume Agent → 后端接口/存储），验证端到端可达与延迟。
- 搭建监控与告警（Prometheus/Grafana + JMX/NodeExporter），形成首版仪表盘与阈值规则。
- 编写并演练关键故障的自动恢复脚本（服务重启、节点隔离、数据副本修复）。
- 输出本周《系统运行评估报告》，并与项目组对齐迭代项。

说明依据：
- 会议纪要（meeting-minutes-6.md）：本周启动 Hadoop 集群部署、推进技术选型和协作规范；运维组负责集群部署方案与落地。
- 项目核心任务说明：强调故障检测与自动恢复闭环，周度评估维度包含“准确性≥85%”“时效性≤5 分钟”“有效性≤5%复发”。

## 关键任务与交付

1) 集群部署与验收（Hadoop 3.x）
- 环境准备：主机名与 `/etc/hosts` 规划、NTP/时间同步、开放端口与防火墙策略、SSH 免密。
- 组件安装：JDK、Hadoop；配置 `core-site.xml`、`hdfs-site.xml`、`yarn-site.xml`、`mapred-site.xml`。
- 初始化与启动：格式化 HDFS（`hdfs namenode -format`）、启动 HDFS/YARN；新增 2 台 DataNode 加入集群。
- 验收检查：
  - 可用性：`hdfs dfsadmin -report`、`yarn node -list`、跑一个示例 MapReduce 任务验证。
  - 健康度：DataNode 副本分布、磁盘水位、NN/DN 心跳稳定性。
- 交付物：部署与拓扑文档、配置文件清单、验收截图/日志。

2) 日志采集链路（Flume）
- 采集范围：Hadoop/HDFS/YARN 组件日志、系统关键日志（如 `syslog`）。
- 部署方式：在各节点部署 Flume Agent（会议纪要明确由运维组推进）。
- 传输与落地：先对接后端接口/存储（MySQL/Redis），形成最小可用链路；记录端到端延迟。
- 验收指标：
  - 日志入库成功率≥95%、平均延迟≤60 秒。
  - 后端接口无错误、存储表结构与索引准备就绪（与后端协作）。
- 交付物：Flume 配置文件、数据流图、延迟与成功率统计。

3) 故障检测与自动恢复基础能力
- 告警规则：
  - NN/DN 离线或心跳异常；Block 丢失/副本不足；磁盘使用率>85%；YARN 队列阻塞；Job 超时。
- 恢复脚本：
  - 服务级：NameNode/ResourceManager/NodeManager/HDFS 守护进程重启。
  - 节点级：隔离故障节点、触发 `hdfs balancer`、副本修复校验（`hdfs fsck`）。
- 演练场景：
  - 场景 A：DataNode 短时离线 → 自动重启与告警关闭；
  - 场景 B：Block 丢失 → 触发副本修复并校验成功。
- 交付物：脚本与演练记录（操作步骤、结果截图、复盘结论）。

4) 监控与告警（可观测性）
- 指标采集：Node Exporter、JMX Exporter（HDFS/YARN 关键指标）。
- 仪表盘：Grafana 初版大盘（集群总览、节点视图、组件视图、告警面板）。
- 告警通道：企业微信/邮件（选择其一先打通），设定阈值与抑制策略。
- 交付物：Grafana 大盘链接/截图、告警规则清单。

5) 备份与回滚策略
- 内容：FSImage、EditLogs 定期备份；Hadoop/Flume 配置版本化；重要数据快照策略。
- 恢复演练：模拟 NameNode 配置误改的回滚恢复。
- 交付物：备份/回滚 SOP、演练记录。

6) 周度评估与改进建议
- 指标口径（对齐项目核心任务说明）：
  - 准确性：故障诊断准确率，目标≥85%。
  - 时效性：从日志产生到修复完成的平均耗时，目标≤5 分钟。
  - 有效性：修复后故障复发率≤5%。
- 数据来源：Flume→后端→MySQL `fault_record` 表（与后端确认字段口径）。
- 报告输出：《系统运行评估报告》（含三维度指标、环比变化、异常案例）。
- 迭代建议：针对低指标项提出具体优化方案（责任人/截止时间）。

## 时间安排（第六周）
- 周一：集群环境准备（主机名/时间同步/SSH 免密/端口与防火墙）；部署 JDK/Hadoop。
- 周二：配置核心文件、初始化 HDFS、启动 HDFS/YARN；完成最小集群可运行。
- 周三：扩容 DataNode、健康验收（报告输出）；对接后端存储准备。
- 周四：部署 Flume Agent 与采集链路打通；采集范围与频率校准。
- 周五：搭建监控（Prometheus/Grafana/JMX/NodeExporter）；设定首版告警规则。
- 周六：编写自动恢复脚本并演练两类故障场景；形成演练记录与改进清单。
- 周日：生成《系统运行评估报告》与本周运维交付清单；与项目组评审并创建下周迭代任务。

## 协作与依赖
- 与后端：确认日志入库表结构与接口稳定性；提供数据口径与查询方式。
- 与测试：联合设计故障注入与恢复验证用例；采集验证数据。
- 与前端：仪表盘展示需求与告警面板原型对齐。
- 变更管理：所有变更走申请与回退预案，避免生产风险。

## 风险与应对
- 技术风险：部署复杂度高 → 采用详细 SOP 与分阶段验收，邀请有经验同学指导。
- 进度风险：周内任务多 → 每日站会复核完成度，优先保证“集群可用+日志链路可达”。
- 协作风险：跨组接口不一致 → 建立数据口径清单与每两天一次对齐沟通。

## 本周交付物清单
- 集群部署与验收文档、配置文件清单、拓扑图。
- Flume 配置与采集链路验证报告。
- 监控仪表盘与告警规则清单。
- 自动恢复脚本与演练记录。
- 《系统运行评估报告》（含三维度指标与迭代建议）。


