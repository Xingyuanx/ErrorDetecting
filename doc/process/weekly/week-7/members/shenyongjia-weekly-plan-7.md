# 沈永佳 - 第7周工作计划

## 一、本周工作目标
基于项目核心任务要求，完成数据库设计优化、数据库迁移实施，深入学习Flume和FastAPI框架，为后续日志采集和后端接口开发奠定基础。

## 二、具体任务安排

### 1. 数据库设计与迁移实施 (优先级：高)
**时间安排：** 周一-周二 (2天)

#### 1.1 数据库设计优化
- **任务描述：** 基于现有数据库设计文档，优化表结构和索引设计
- **具体工作：**
  - 审查故障记录表(fault_records)结构，确保支持故障类型扩展
  - 优化执行日志表(exec_logs)，增强脚本执行监控能力
  - 完善集群状态表(cluster_status)，支持多维度性能监控
  - 验证系统日志表(system_logs)设计，确保高效日志存储和查询
- **交付物：** 优化后的数据库设计文档和建表脚本

#### 1.2 数据库迁移实施
- **任务描述：** 执行数据库创建和初始化，建立完整的数据存储环境
- **具体工作：**
  - 安装配置MySQL 8.0+环境
  - 执行建表脚本，创建hadoop_fault_db数据库
  - 配置数据库用户权限和安全设置
  - 创建初始化数据和测试数据
  - 验证数据库连接和基本CRUD操作
- **交付物：** 可用的数据库环境和连接测试报告

### 2. Flume框架学习与实践 (优先级：高)
**时间安排：** 周三-周四上午 (1.5天)

#### 2.1 Flume基础学习
- **学习目标：** 掌握Flume架构原理和配置方法
- **学习内容：**
  - Flume架构组件：Source、Channel、Sink的工作原理
  - Flume Agent配置文件编写规范
  - 常用Source类型：exec Source、spooldir Source等
  - Channel类型选择：memory Channel vs file Channel
  - Sink配置：HDFS Sink、HTTP Sink等
- **实践任务：**
  - 搭建Flume 1.11.0+测试环境
  - 编写hadoop-log-agent.conf配置文件
  - 实现Hadoop日志实时采集功能

#### 2.2 Flume在项目中的应用
- **应用场景：** 实现Hadoop集群日志全量实时采集
- **配置要求：**
  - Source：监控/var/log/hadoop/*.log和/apps/yarn/logs/目录
  - Channel：根据集群规模选择合适类型(capacity=10000)
  - Sink：对接FastAPI接口(http://backend-ip:8000/api/log/auto-upload)
- **交付物：** Flume配置文件和测试报告

### 3. FastAPI框架学习与开发 (优先级：高)
**时间安排：** 周四下午-周五 (1.5天)

#### 3.1 FastAPI基础学习
- **学习目标：** 掌握FastAPI框架核心特性和开发模式
- **学习内容：**
  - FastAPI项目结构和依赖管理
  - 路由定义和请求处理
  - 数据模型定义(Pydantic)
  - 数据库集成(MySQL连接器)
  - 异步编程和性能优化
  - API文档自动生成

#### 3.2 后端接口开发实践
- **开发目标：** 实现日志接收和集群状态查询接口
- **核心接口：**
  - `POST /api/log/auto-upload` - 接收Flume发送的日志数据
  - `GET /api/cluster/status` - 查询Hadoop集群状态
  - `POST /api/llm/diagnose` - 大模型故障诊断接口(预留)
- **技术实现：**
  - 使用uvicorn作为ASGI服务器
  - 集成mysql-connector-python进行数据库操作
  - 实现日志结构化处理(preprocess_log函数)
  - 添加Redis缓存支持
- **交付物：** 基础后端API服务和接口测试文档

### 4. 学习成果整理与文档编写 (优先级：中)
**时间安排：** 周五下午 (0.5天)

#### 4.1 技术学习总结
- **Flume学习报告：**
  - Flume架构原理总结
  - 配置文件编写最佳实践
  - 性能调优建议
  - 常见问题和解决方案

#### 4.2 FastAPI开发指南
- **开发文档：**
  - 项目环境搭建指南
  - 核心接口设计说明
  - 数据库集成方案
  - 部署和运维建议

## 三、风险识别与应对

### 3.1 技术风险
- **风险1：** Flume配置复杂，可能影响日志采集效率
  - **应对措施：** 先在测试环境验证配置，逐步优化参数
- **风险2：** FastAPI与MySQL集成可能遇到连接池问题
  - **应对措施：** 研究连接池配置，准备备用方案

### 3.2 进度风险
- **风险：** 学习任务较重，可能影响交付质量
  - **应对措施：** 优先完成核心功能，非关键特性可延后实现

## 四、成功标准

### 4.1 数据库迁移成功标准
- [ ] 数据库环境搭建完成，所有表创建成功
- [ ] 数据库连接测试通过
- [ ] 基本CRUD操作验证通过

### 4.2 Flume学习成功标准
- [ ] 能够独立配置Flume Agent
- [ ] 实现Hadoop日志实时采集
- [ ] 日志数据能够正确传输到指定目标

### 4.3 FastAPI开发成功标准
- [ ] 核心API接口开发完成
- [ ] 接口功能测试通过
- [ ] 数据库集成正常工作
- [ ] API文档生成完整

## 五、下周计划预览
- 完善后端接口功能，增加错误处理和日志记录
- 开始前端页面开发，实现集群状态监控界面
- 集成Flume和FastAPI，建立完整的日志采集链路
- 准备系统集成测试方案