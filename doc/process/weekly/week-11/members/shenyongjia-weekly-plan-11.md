# 第十一周周计划（沈永佳）

## 目标概述
- 完善数据库服务与相关权限配置，确保后端可稳定访问数据库。
- 完成网络设置（监听地址、访问策略），解决局域网环境下的连接问题。
- 插入测试数据并完成端到端联调（前端登录/注册 → 后端 → 数据库）。
- 输出联调与排障手册，沉淀可复用步骤与失败案例。

## 任务清单
- 数据库服务与网络设置
  - 调整 `postgresql.conf`：设置 `listen_addresses='*'` 或指定局域网地址。
  - 配置 `pg_hba.conf`：为局域网网段开放策略，如 `host    all    all    192.168.43.0/24    scram-sha-256`。
  - 验证防火墙与端口开放（确保 `5432` 对内网可访问）。
- 权限与账户
  - 创建业务用户并授予目标库的连接与基础查询权限。
  - 校验密码策略与加密方式，记录账户与权限变更。
- 初始化与测试数据
  - 执行 `doc/project/数据库建表脚本_postgres.sql`，创建核心业务表与初始数据。
  - 插入测试用户（含管理员/操作员/观察员）与典型业务数据，便于联调。
- 后端对接与联调
  - 在 `backend/.env` 配置 `DATABASE_URL` 或分项变量（`DB_HOST/PORT/NAME/USER/PASSWORD`），参考 `backend/app/config.py:6-21`。
  - 启动后端（Windows 示例）：`.\\.venv\\Scripts\\python.exe -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload`（参考 `backend/README.md:73-92`）。
  - 执行接口联调：`/api/v1/user/register`、`/api/v1/user/login`、`/api/v1/user/me`。
- 前端联调
  - 确认 `frontend-vue/vite.config.ts:6-18` 的代理目标为后端地址（`VITE_API_TARGET` 可覆盖）。
  - 联调登录流程（参考前端 Store：`frontend-vue/src/app/stores/auth.ts:33-56, 58-75`）。
- 排障与文档
  - 输出联调排障清单（连接串错误、认证失败、网络策略不匹配等）。
  - 补充 curl/脚本示例与常见错误对照表。

## 时间安排
- 周一：数据库网络与访问策略调整；开放端口与安全组配置，完成基础连通性测试。
- 周二：账户与权限梳理；执行建表脚本与初始数据导入；输出变更记录。
- 周三：后端环境变量与启动验证；注册与登录接口打通；记录失败场景。
- 周四：前端代理与登录联调；完善错误提示与回归用例。
- 周五：端到端回归与性能基线（简单压测）；整理联调与排障手册。
- 周末：复盘与文档完善，提交周总结与后续改进计划。

## 验收标准
- 后端服务可在局域网内稳定连接数据库并完成读写。
- 前端登录/注册流程端到端通过，能获取并携带 `Bearer` 令牌访问受限接口。
- 提供操作手册与失败案例，复现路径清晰、排障步骤可执行。
