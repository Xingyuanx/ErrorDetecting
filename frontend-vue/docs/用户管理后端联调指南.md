# 用户管理模块后端联调指南

## 1. 模块概述
用户管理模块主要用于管理员对系统用户的生命周期管理，包括查询用户列表、新增用户、修改用户角色/状态以及删除用户。

## 2. 认证说明
所有接口均需在 Header 中携带 Bearer Token 进行身份校验，且当前登录用户必须拥有 `admin` 权限。
- **Header**: `Authorization: Bearer <your_token>`

## 3. 接口列表

### 3.1 获取用户列表
- **URL**: `/api/v1/users`
- **Method**: `GET`
- **说明**: 获取系统中所有注册用户的列表。
- **响应格式 (推荐)**: 
  ```json
  {
    "users": [
      {
        "username": "admin",
        "full_name": "系统管理员",
        "email": "admin@example.com",
        "role": "admin",
        "status": "enabled"
      }
    ]
  }
  ```
- **前端兼容性**: 前端已做适配，支持直接返回数组 `[]`，并兼容 `user_name`/`name` 等字段名变体。

### 3.2 新增用户
- **URL**: `/api/v1/users`
- **Method**: `POST`
- **Body 格式**: `application/json`
- **Payload 示例**:
  ```json
  {
    "username": "new_user",
    "full_name": "新用户姓名",
    "email": "user@example.com",
    "password": "password123",
    "role": "operator",
    "status": "enabled"
  }
  ```
- **关键点**: 前端已补全 `full_name` 字段，请后端确保接收并存储该字段。

### 3.3 修改用户信息 (状态/角色)
- **URL**: `/api/v1/users/{username}`
- **Method**: `PATCH`
- **说明**: 用于修改用户的角色或启用/禁用状态。
- **Payload 示例 (修改状态)**:
  ```json
  { "status": "disabled" } 
  ```
- **Payload 示例 (修改角色)**:
  ```json
  { "role": "admin" }
  ```

### 3.4 删除用户
- **URL**: `/api/v1/users/{username}`
- **Method**: `DELETE`
- **说明**: 从系统中永久删除指定用户。

## 4. 数据字典

### 4.1 用户角色 (Role)
| 标识符 | 名称 | 说明 |
| :--- | :--- | :--- |
| `admin` | 管理员 | 拥有最高管理权限，可进入用户管理界面 |
| `operator` | 操作员 | 拥有集群操作权限 |
| `observer` | 观察员 | 仅拥有查看权限 |

### 4.2 用户状态 (Status)
| 标识符 | 名称 | 说明 |
| :--- | :--- | :--- |
| `enabled` | 启用 | 正常登录使用 |
| `pending` | 待审核 | 注册后尚未激活 |
| `disabled` | 禁用 | 账号被封禁，无法登录 |

## 5. 错误处理规范
前端会解析后端返回的错误详情并展示给用户。建议后端在出错时返回如下结构：
- **状态码**: `400` (参数错误), `401` (未授权), `403` (权限不足), `500` (服务器异常)
- **Body**:
  ```json
  {
    "detail": "简短的错误摘要",
    "errors": [
      { "message": "具体的错误原因1" },
      { "message": "具体的错误原因2" }
    ]
  }
  ```
