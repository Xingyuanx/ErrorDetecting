# 操作日志后端联调指南

本文档旨在指导后端开发人员如何对接“操作日志”页面的前端接口。

## 1. 接口概述

操作日志页面通过 `GET` 请求从后端获取系统操作日志。该页面仅限 `admin`（管理员）角色访问。

## 2. 接口定义

### 获取操作日志列表

- **请求方法**: `GET`
- **请求路径**: `/api/v1/operation-logs`
- **鉴权要求**: 需在 Header 中携带 `Authorization: Bearer <token>`

#### 响应格式 (JSON)

前端支持多种字段名的适配，建议优先使用以下结构：

```json
{
  "items": [
    {
      "id": "operation-12345",
      "timestamp": "2025-11-07T10:20:03Z",
      "user": "admin",
      "action": "用户登录",
      "detail": "管理员 admin 成功登录系统"
    }
  ]
}
```

#### 字段说明与适配逻辑

前端会自动适配以下备用字段名（按优先级排序）：

| 前端展示字段 | 推荐后端字段 | 备用适配字段             |
| :----------- | :----------- | :----------------------- |
| 唯一标识     | `id`         | `operation_id`           |
| 时间戳       | `timestamp`  | `created_at`, `time`     |
| 操作用户     | `user`       | `username`, `operator`   |
| 动作名称     | `action`     | `operation`              |
| 详情描述     | `detail`     | `description`, `content` |

## 3. 前端处理细节

1. **时间格式**: 前端会自动处理 ISO 格式的时间字符串（如 `2025-11-07T10:20:03Z`），将其转换为更易读的 `2025-11-07 10:20:03` 格式展示。
2. **错误处理**: 如果接口返回 401/403，前端会自动根据路由守卫引导至登录页或显示权限不足。如果接口返回 500 或网络错误，页面会展示具体的报错信息。
3. **刷新功能**: 页面提供了“刷新”按钮，会重新触发一次该接口请求。

## 4. 示例代码 (Axios 调用)

```typescript
const r = await api.get("/api/v1/operation-logs", {
  headers: { Authorization: `Bearer ${token}` },
});
```

## 5. 权限说明

操作日志属于敏感数据，后端接口**必须**校验 `token` 中的角色信息，确保只有具有管理员权限的用户才能获取数据。
